{% extends "layout.html" %}
{% block content %}
<div class="container mt-4">

  <!-- Breadcrumb -->
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="/">Home</a></li>
      <li class="breadcrumb-item"><a href="/sample">Sample Dataset</a></li>
      <li class="breadcrumb-item active" aria-current="page">Configure SAS Analysis</li>
    </ol>
  </nav>

  <h2 class="mb-3">‚öôÔ∏è Configure SAS Procedures</h2>
  <p class="text-muted">Step 5 of 6 ¬∑ Choose the appropriate SAS procedures based on your sampled data.</p>

  <!-- PROC Tabs -->
  <ul class="nav nav-tabs" id="procTabs" role="tablist">
    {% for proc in ['MEANS', 'FREQ', 'LOGISTIC', 'SQL', 'CORR', 'REG', 'UNIVARIATE', 'SGPLOT'] %}
    <li class="nav-item" role="presentation">
      <button class="nav-link {% if loop.first %}active{% endif %}" id="{{ proc.lower() }}-tab" data-bs-toggle="tab" data-bs-target="#{{ proc.lower() }}" type="button" role="tab">
        PROC {{ proc }}
      </button>
    </li>
    {% endfor %}
  </ul>

  <form method="POST" action="/config-analysis">
    <div class="tab-content p-4 border border-top-0 bg-white shadow-sm rounded-bottom" id="procTabsContent">

      <!-- MEANS -->
      <div class="tab-pane fade show active" id="means" role="tabpanel">
        <h5 class="text-primary">üìä PROC MEANS</h5>
        <p>Compute basic stats (mean, min, max, std) for numeric columns.</p>
        <select class="form-select mb-3" name="means_columns" multiple>
          {% for col in numeric_columns %}
            <option value="{{ col }}">{{ col }}</option>
          {% endfor %}
        </select>
      </div>

      <!-- FREQ -->
      <div class="tab-pane fade" id="freq" role="tabpanel">
        <h5 class="text-success">üìà PROC FREQ</h5>
        <p>Frequency table for categorical columns.</p>
        <select class="form-select mb-3" name="freq_columns" multiple>
          {% for col in categorical_columns %}
            <option value="{{ col }}">{{ col }}</option>
          {% endfor %}
        </select>
      </div>

      <!-- LOGISTIC -->
      <div class="tab-pane fade" id="logistic" role="tabpanel">
        <h5 class="text-danger">üìâ PROC LOGISTIC</h5>
        <label>Target (binary):</label>
        <select class="form-select mb-2" name="logistic_target">
          {% for col in binary_columns %}
            <option value="{{ col }}">{{ col }}</option>
          {% endfor %}
        </select>
        <label>Predictors:</label>
        <select class="form-select mb-3" name="logistic_predictors" multiple>
          {% for col in numeric_columns %}
            <option value="{{ col }}">{{ col }}</option>
          {% endfor %}
        </select>
      </div>

      <!-- SQL -->
      <div class="tab-pane fade" id="sql" role="tabpanel">
        <h5 class="text-dark">üßæ PROC SQL</h5>
        <p>Write a custom SQL query (e.g. <code>SELECT * FROM data WHERE col > 100</code>)</p>
        <textarea class="form-control" name="sql_query" rows="4" placeholder="SELECT * FROM data;"></textarea>
      </div>

      <!-- CORR -->
      <div class="tab-pane fade" id="corr" role="tabpanel">
        <h5 class="text-warning">üîó PROC CORR</h5>
        <p>Show correlation between numeric columns.</p>
        <select class="form-select mb-3" name="corr_columns" multiple>
          {% for col in numeric_columns %}
            <option value="{{ col }}">{{ col }}</option>
          {% endfor %}
        </select>
      </div>

      <!-- REG -->
      <div class="tab-pane fade" id="reg" role="tabpanel">
        <h5 class="text-info">üìà PROC REG</h5>
        <label>Target:</label>
        <select class="form-select mb-2" name="reg_target">
          {% for col in numeric_columns %}
            <option value="{{ col }}">{{ col }}</option>
          {% endfor %}
        </select>
        <label>Predictors:</label>
        <select class="form-select mb-3" name="reg_predictors" multiple>
          {% for col in numeric_columns %}
            <option value="{{ col }}">{{ col }}</option>
          {% endfor %}
        </select>
      </div>

      <!-- UNIVARIATE -->
      <div class="tab-pane fade" id="univariate" role="tabpanel">
        <h5 class="text-secondary">üìè PROC UNIVARIATE</h5>
        <p>Detailed stats: skewness, kurtosis, percentiles.</p>
        <select class="form-select mb-3" name="univariate_columns" multiple>
          {% for col in numeric_columns %}
            <option value="{{ col }}">{{ col }}</option>
          {% endfor %}
        </select>
      </div>

      <!-- SGPLOT -->
      <div class="tab-pane fade" id="sgplot" role="tabpanel">
        <h5 class="text-purple">üìä PROC SGPLOT</h5>
        <p>Select X and Y axis for visual plotting.</p>
        <label>X-axis:</label>
        <select class="form-select mb-2" name="sgplot_x">
          {% for col in df.columns %}
            <option value="{{ col }}">{{ col }}</option>
          {% endfor %}
        </select>
        <label>Y-axis:</label>
        <select class="form-select mb-3" name="sgplot_y">
          {% for col in df.columns %}
            <option value="{{ col }}">{{ col }}</option>
          {% endfor %}
        </select>
      </div>

      <!-- GLM -->
      <div class="tab-pane fade" id="glm" role="tabpanel">
        <h5 class="text-danger">üìä PROC GLM</h5>
        <p>General Linear Model (for ANOVA, interaction terms, multiple predictors).</p>
        <label>Target (dependent variable):</label>
        <select class="form-select mb-2" name="glm_target">
          {% for col in numeric_columns %}
            <option value="{{ col }}">{{ col }}</option>
          {% endfor %}
        </select>
        <label>Predictors (independent variables):</label>
        <select class="form-select mb-3" name="glm_predictors" multiple>
          {% for col in df.columns %}
            <option value="{{ col }}">{{ col }}</option>
          {% endfor %}
        </select>
      </div>

    </div>

    <!-- Submit button -->
    <div class="mt-4 text-end">
      <button type="submit" class="btn btn-primary">
        üíæ Save Configuration and Continue
      </button>
    </div>
  </form>
</div>
{% endblock %}
